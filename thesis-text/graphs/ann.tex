
\begin{figure}
	\centering
	\begin{tikzpicture}[x=2.2cm,y=1.4cm]
		\message{^^JNeural network with arrows}
		\readlist\Nnod{3,4,4,2} % array of number of nodes per layer
		
		\message{^^J  Layer}
		\foreachitem \N \in \Nnod{ % loop over layers
			\edef\lay{\Ncnt} % alias of index of current layer
			\message{\lay,}
			\pgfmathsetmacro\prev{int(\Ncnt-1)} % number of previous layer
			\foreach \i [evaluate={\y=\N/2-\i; \x=\lay; \n=\nstyle;}] in {1,...,\N}{ % loop over nodes
				
				% NODES
				\node[node \n] (N\lay-\i) at (\x,\y) {$a_\i^{\prev}$};
				
				% CONNECTIONS
				\ifnum\lay>1 % connect to previous layer
					\foreach \j in {1,...,\Nnod[\prev]}{ % loop over nodes in previous layer
						\draw[connect arrow] (N\prev-\j) -- (N\lay-\i); % connect arrows directly
						%\draw[connect arrow] (N\prev-\j) -- (N\lay-\i'); % connect arrows to shifted node
					}
				\fi % else: nothing to connect first layer
			}
		}
		
		% LABELS
		\node[above=5,align=center,mygreen!60!black] at (N1-1.90) {input\\[-0.2em]layer};
	%	\node[above=2,align=center,myblue!60!black] at (N3-1.90) {hidden layers};
		\node[above=2,left=0.5cm,align=center,myblue!60!black] at (N3-1.90) {hidden\\[-0.2em]layers};
		\node[above=8,align=center,myred!60!black] at (N\Nnodlen-1.90) {output\\[-0.2em]layer};
		
		
	\end{tikzpicture}
	\caption{Visual representation of a neural network}
	\label{fig:ann}

\end{figure}




%\begin{tikzpicture}[x=2.7cm,y=1.6cm]
%	\message{^^JNeural network activation}
%	\def\NI{5} % number of nodes in input layers
%	\def\NO{4} % number of nodes in output layers
%	\def\yshift{0.4} % shift last node for dots
%	
%	% INPUT LAYER
%	\foreach \i [evaluate={\c=int(\i==\NI); \y=\NI/2-\i-\c*\yshift; \index=(\i<\NI?int(\i):"n");}]
%	in {1,...,\NI}{ % loop over nodes
%		\node[node in,outer sep=0.6] (NI-\i) at (0,\y) {$a_{\index}^{(0)}$};
%	}
%	
%	% OUTPUT LAYER
%	\foreach \i [evaluate={\c=int(\i==\NO); \y=\NO/2-\i-\c*\yshift; \index=(\i<\NO?int(\i):"m");}]
%	in {\NO,...,1}{ % loop over nodes
%		\ifnum\i=1 % high-lighted node
%			\node[node hidden]
%			(NO-\i) at (1,\y) {$a_{\index}^{(1)}$};
%			\foreach \j [evaluate={\index=(\j<\NI?int(\j):"n");}] in {1,...,\NI}{ % loop over nodes in previous layer
%				\draw[connect,white,line width=1.2] (NI-\j) -- (NO-\i);
%				\draw[connect] (NI-\j) -- (NO-\i)
%				node[pos=0.50] {\contour{white}{$w_{1,\index}$}};
%			}
%		\else % other light-colored nodes
%			\node[node,blue!20!black!80,draw=myblue!20,fill=myblue!5]
%			(NO-\i) at (1,\y) {$a_{\index}^{(1)}$};
%			\foreach \j in {1,...,\NI}{ % loop over nodes in previous layer
%				%\draw[connect,white,line width=1.2] (NI-\j) -- (NO-\i);
%				\draw[connect,myblue!20] (NI-\j) -- (NO-\i);
%			}
%		\fi
%	}
%	
%
%	
%
%	
%\end{tikzpicture}


